    x="IL    x="IL    x="IL    x="IL    x="IL    x="IL    x="I ILMN+ONT Mean F-score (ont+sentdhio)\n*Tiles marked with cyan stars exceed ILMN 30x baseline (giabHC sent+sentd)*"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(scales)
library(ggplot2)
library(dplyr)
library(scales)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Get baseline ILMN 30x (giabHC, sent+sentd)
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd'
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid ILMN+ONT (ont+sentdhio)
hybrid_ilmn_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdhio',
    ILMN_cov > 0, ONT_cov > 0
  ) %>%
  group_by(CmpFootprint, SNPClass, ILMN_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = sprintf("%.3f\n[%.3f]", mean_Fscore, baseline_Fscore)
  )
# Plot
ggplot(hybrid_ilmn_ont, aes(x=factor(ILMN_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  geom_point(data=hybrid_ilmn_ont %>% filter(exceeds_baseline),
             shape=8, size=1.8, color='cyan') +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_gradientn(
    colours = c("darkred", "orange", "gold", "yellowgreen", "forestgreen", "darkcyan", "blue", "darkblue"),
    values = rescale(c(0, 0.5, 0.75, 0.85, 0.925, 0.95, 0.975, 1)),
    limits=c(0.5, 1),
    oob=squish,
    name="Mean F-score"
  ) +
  labs(
    x="ILMN Coverage",
    y="ONT Coverage",
    title="Hybrid ILMN+ONT Mean F-score (ont+sentdhio)\n*Tiles marked with cyan stars exceed ILMN 30x baseline (giabHC sent+sentd)*"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(ggplot2)
library(dplyr)
library(scales)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Baseline ILMN 30x (giabHC, sent+sentd), excluding unwanted SNP classes
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd',
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid ILMN+ONT data (ont+sentdhio)
hybrid_ilmn_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdhio',
    ILMN_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, ILMN_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = ifelse(exceeds_baseline,
                   sprintf("%.3f [%.3f] *", mean_Fscore, baseline_Fscore),
                   sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore))
  )
# Plot ILMN+ONT hybrid
ggplot(hybrid_ilmn_ont, aes(x=factor(ILMN_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_viridis_c(name="Mean F-score", limits=c(0.5,1), oob=squish) +
  labs(
    x="ILMN Coverage",
    y="ONT Coverage",
    title="Hybrid ILMN+ONT Mean F-score (ont+sentdhio)\n(* indicates surpassing ILMN 30x baseline (giabHC sent+sentd))"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(ggplot2)
library(dplyr)
library(scales)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Baseline ILMN 30x (giabHC, sent+sentd), excluding unwanted SNP classes
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd',
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid ILMN+ONT data (ont+sentdhio)
hybrid_ilmn_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdhio',
    ILMN_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, ILMN_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = ifelse(exceeds_baseline,
                   sprintf("%.3f [%.3f] *", mean_Fscore, baseline_Fscore),
                   sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore))
  )
# Plot ILMN+ONT hybrid
ggplot(hybrid_ilmn_ont, aes(x=factor(ILMN_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_viridis_c(name="Mean F-score", limits=c(0.5,1), oob=squish) +
  labs(
    x="ILMN Coverage",
    y="ONT Coverage",
    title="Hybrid ILMN+ONT Mean F-score (ont+sentdhio)\n(* indicates surpassing ILMN 30x baseline (giabHC sent+sentd))"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(ggplot2)
library(dplyr)
library(scales)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Baseline ILMN 30x (giabHC, sent+sentd), excluding unwanted SNP classes
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd',
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid ILMN+ONT data (ont+sentdhio)
hybrid_ilmn_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdhio',
    ILMN_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, ILMN_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore)
  )
# Plot ILMN+ONT hybrid
ggplot(hybrid_ilmn_ont, aes(x=factor(ILMN_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  geom_text(data=hybrid_ilmn_ont %>% filter(exceeds_baseline),
            aes(label='*'), color='magenta', size=6, nudge_x=0.3) +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_viridis_c(name="Mean F-score", limits=c(0.5,1), oob=squish, option='viridis',
                       values=rescale(c(0.5, 0.997, 1))) +
  labs(
    x="ILMN Coverage",
    y="ONT Coverage",
    title="Hybrid ILMN+ONT Mean F-score (ont+sentdhio)\n(* indicates surpassing ILMN 30x baseline (giabHC sent+sentd))"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
# Hybrid UG+ONT data (ont+senthuo)
hybrid_ug_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+senthuo',
    UG_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, UG_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore)
  )
# Plot UG+ONT hybrid
ggplot(hybrid_ug_ont, aes(x=factor(UG_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  geom_text(data=hybrid_ug_ont %>% filter(exceeds_baseline),
            aes(label='*'), color='magenta', size=6, nudge_x=0.3) +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_viridis_c(name="Mean F-score", limits=c(0.5,1), oob=squish, option='viridis',
                       values=rescale(c(0.5, 0.997, 1))) +
  labs(
    x="UG Coverage",
    y="ONT Coverage",
    title="Hybrid UG+ONT Mean F-score (ont+senthuo)\n(* indicates surpassing ILMN 30x baseline (giabHC sent+sentd))"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(ggplot2)
library(dplyr)
library(scales)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Baseline ILMN 30x (giabHC, sent+sentd), excluding unwanted SNP classes
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd',
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid UG+ONT data (ont+senthuo)
hybrid_ug_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+senthuo',
    UG_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, UG_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore)
  )
# Plot UG+ONT hybrid
ggplot(hybrid_ug_ont, aes(x=factor(UG_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  geom_text(data=hybrid_ug_ont %>% filter(exceeds_baseline),
            aes(label='*'), color='magenta', size=6, nudge_x=0.3) +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_  scale_  scale_  scale_  scale_  scale_  scale_  scale_  scale_  scaln='viridis',
                       values=rescale(c(0.5, 0.997, 1))) +
  labs(
    x="UG Coverage",
    y="ONT Coverage",
    title="Hybrid UG+ONT Mean F-score (ont+senthuo)\n(* indicates surpassing ILMN 30x baseline (giabHC\
 sent+sentd))"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(ggplot2)
library(dplyr)
library(scales)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Baseline ILMN 30x (giabHC, sent+sentd), excluding unwanted SNP classes
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd',
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid UG+ONT data (ont+senthuo)
hybrid_ug_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+senthuo',
    UG_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, UG_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore)
  )
# Plot UG+ONT hybrid
ggplot(hybrid_ug_ont, aes(x=factor(UG_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  geom_text(data=hybrid_ug_ont %>% filter(exceeds_baseline),
            aes(label='*'), color='magenta', size=6, nudge_x=0.3) +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_viridis_c(name="Mean F-score", limits=c(0.5,1), oob=squish, option='viridis',
                       values=rescale(c(0.5, 0.997, 1))) +
  labs(
    x="UG Coverage",
    y="ONT Coverage",
    title="Hybrid UG+ONT Mean F-score (ont+senthuo)\n(* indicates surpassing ILMN 30x baseline (giabHC\
 sent+sentd))"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(ggplot2)
library(dplyr)
library(scales)
library(viridis)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Baseline ILMN 30x (giabHC, sent+sentd), excluding unwanted SNP classes
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd',
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid UG+ONT data (ont+senthuo)
hybrid_ug_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdhuo',
    UG_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, UG_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore)
  )
# Plot UG+ONT hybrid with correct color scale
ggplot(hybrid_ug_ont, aes(x=factor(UG_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  geom_text(data=hybrid_ug_ont %>% filter(exceeds_baseline),
            aes(label='*'), color='magenta', size=6, nudge_x=0.3) +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_gradientn(
    colours = viridis(256),
    values = rescale(c(0.5, 0.75, 0.9, 0.95, 0.975, 0.99, 0.997, 1)),
    limits = c(0.5, 1),
    oob = squish,
    name = "Mean F-score"
  ) +
  labs(
    x = "UG Coverage",
    y = "ONT Coverage",
    title = "Hybrid UG+ONT Mean F-score (ont+senthuo)\n(* indicates surpassing ILMN 30x baseline (giabHC sent+sentd))"
  ) +
  theme_bw(base_size = 12) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(dplyr)
library(scales)
d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)
# Baseline ILMN 30x (giabHC, sent+sentd), excluding unwanted SNP classes
baseline_ilmn <- d %>%
  filter(
    CmpFootprint == 'giabHC',
    ILMN_cov == 30,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd',
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(SNPClass) %>%
  summarize(baseline_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')
# Hybrid ILMN+ONT data (ont+sentdhio)
hybrid_ilmn_ont <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdhio',
    ILMN_cov > 0, ONT_cov > 0,
    !SNPClass %in% c('Indel_gt50', 'DEL_gt50', 'INS_gt50')
  ) %>%
  group_by(CmpFootprint, SNPClass, ILMN_cov, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop') %>%
  left_join(baseline_ilmn, by='SNPClass') %>%
  mutate(
    exceeds_baseline = mean_Fscore > baseline_Fscore,
    label = sprintf("%.3f [%.3f]", mean_Fscore, baseline_Fscore)
  )
# Plot ILMN+ONT hybrid
ggplot(hybrid_ilmn_ont, aes(x=factor(ILMN_cov), y=factor(ONT_cov), fill=mean_Fscore)) +
  geom_tile(color='grey90') +
  geom_text(aes(label=label), size=2.2, color='grey10') +
  geom_text(data=hybrid_ilmn_ont %>% filter(exceeds_baseline),
            aes(label='*'), color='magenta', size=6, nudge_x=0.3) +
  facet_grid(SNPClass ~ CmpFootprint) +
  scale_fill_viridis_c(name="Mean F-score", limits=c(0.5,1), oob=squish, option='viridis',
                       values=rescale(c(0.5, 0.997, 1))) +
  labs(
    x="ILMN Coverage",
    y="ONT Coverage",
    title="Hybrid ILMN+ONT Mean F-score (ont+sentdhio)\n(* indicates surpassing ILMN 30x baseline (giabHC sent+sentd))"
  ) +
  theme_bw(base_size=12) +
  theme(axis.text.x=element_text(angle=45, hjust=1))
library(ggplot2)
library(dplyr)
d<-read.csv('./giab_all_downsampled_proc.tsv',sep='\t',header=TRUE)
# Prepare the data
d_filtered <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    ILMN_cov > 0,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd'
  ) %>%
  group_by(CmpFootprint, SNPClass, ILMN_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE)) %>%
  ungroup()
# Create line plot
ggplot(d_filtered, aes(x = ILMN_cov, y = mean_Fscore, color = SNPClass)) +
  geom_line(size=0.25) +
  geom_point(size=0.75) +
  facet_wrap(~CmpFootprint) +
  labs(
    x = "ILMN Coverage",
    y = "Mean F-score",
    title = "Mean F-score vs. ILMN Coverage by SNP Class (sent+sentd)",
    color = "SNP Class"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(dplyr)
d<-read.csv('./giab_all_downsampled_proc.tsv',sep='\t',header=TRUE)
# Prepare the data
d_filtered <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    ILMN_cov > 0,
    paste0(Aligner, "+", SNVCaller) == 'sent+sentd'
  ) %>%
  group_by(CmpFootprint, SNPClass, ILMN_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE)) %>%
  ungroup()
# Create line plot
ggplot(d_filtered, aes(x = ILMN_cov, y = mean_Fscore, color = SNPClass)) +
  geom_line(size=0.25) +
  geom_point(size=0.75) +
  facet_wrap(~CmpFootprint) +
  labs(
    x = "ILMN Coverage",
    y = "Mean F-score",
    title = "Mean F-score vs. ILMN Coverage by SNP Class (sent+sentd)",
    color = "SNP Class"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + coord_cartesian(ylim=c(0.99,1))
library(ggplot2)
library(dplyr)
d<-read.csv('./giab_all_downsampled_proc.tsv',sep='\t',header=TRUE)
# Prepare the data
d_filtered <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    ONT_cov > 0,
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdont'
  ) %>%
  group_by(CmpFootprint, SNPClass, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE)) %>%
  ungroup()
# Create line plot
ggplot(d_filtered, aes(x = ONT_cov, y = mean_Fscore, color = SNPClass)) +
  geom_line(size=0.25) +
  geom_point(size=0.75) +
  facet_wrap(~CmpFootprint) +
  labs(
    x = "ONT Coverage",
    y = "F-score",
    title = "F-score vs. ONT Coverage by SNP Class (sent+sentd), HG006, hg38",
    color = "SNP Class"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(dplyr)
d<-read.csv('./giab_all_downsampled_proc.tsv',sep='\t',header=TRUE)
# Prepare the data
d_filtered <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    ONT_cov > 0,
    paste0(Aligner, "+", SNVCaller) == 'ont+sentdont'
  ) %>%
  group_by(CmpFootprint, SNPClass, ONT_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE)) %>%
  ungroup()
# Create line plot
ggplot(d_filtered, aes(x = ONT_cov, y = mean_Fscore, color = SNPClass)) +
  geom_line(size=0.25) +
  geom_point(size=0.75) +
  facet_wrap(~CmpFootprint) +
  labs(
    x = "ONT Coverage",
    y = "F-score",
    title = "F-score vs. ONT Coverage by SNP Class (sent+sentd), HG006, hg38",
    color = "SNP Class"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + coord_cartesian(ylim=c(0.99,1))
library(ggplot2)
library(dplyr)


d<-read.csv('./giab_all_downsampled_proc.tsv',sep='\t',header=TRUE)

# Prepare the data
d_filtered <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    UG_cov > 0,
    paste0(Aligner, "+", SNVCaller) == 'ug+sentdug'
  ) %>%
  group_by(CmpFootprint, SNPClass, UG_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE)) %>%
  ungroup()

# Create line plot
ggplot(d_filtered, aes(x = UG_cov, y = mean_Fscore, color = SNPClass)) +
  geom_line(size=0.25) +
  geom_point(size=0.75) +
  facet_wrap(~CmpFootprint) +
  labs(
    x = "UG Coverage",
    y = "F-score",
    title = "F-score vs. UG Coverage by SNP Class (sent+sentd), HG006, hg38",
    color = "SNP Class"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))
library(ggplot2)
library(dplyr)


d<-read.csv('./giab_all_downsampled_proc.tsv',sep='\t',header=TRUE)

# Prepare the data
d_filtered <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    UG_cov > 0,
    paste0(Aligner, "+", SNVCaller) == 'ug+sentdug'
  ) %>%
  group_by(CmpFootprint, SNPClass, UG_cov) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE)) %>%
  ungroup()

# Create line plot
ggplot(d_filtered, aes(x = UG_cov, y = mean_Fscore, color = SNPClass)) +
  geom_line(size=0.25) +
  geom_point(size=0.75) +
  facet_wrap(~CmpFootprint) +
  labs(
    x = "UG Coverage",
    y = "F-score",
    title = "F-score vs. UG Coverage by SNP Class (sent+sentd), HG006, hg38",
    color = "SNP Class"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + coord_cartesian(ylim=c(0.99,1))
library(ggplot2)
library(dplyr)

d <- read.csv('./giab_all_downsampled_proc.tsv', sep='\t', header=TRUE)

# Combine ILMN, ONT, and UG data
combined_data <- d %>%
  filter(
    CmpFootprint %in% c('giabHC', 'giabHC_x_ultima'),
    (ILMN_cov > 0 & paste0(Aligner, "+", SNVCaller) == 'sent+sentd') |
    (ONT_cov > 0 & paste0(Aligner, "+", SNVCaller) == 'ont+sentdont') |
    (UG_cov > 0 & paste0(Aligner, "+", SNVCaller) == 'ug+sentdug')
  ) %>%
  mutate(
    Coverage = case_when(
      paste0(Aligner, "+", SNVCaller) == 'sent+sentd' ~ ILMN_cov,
      paste0(Aligner, "+", SNVCaller) == 'ont+sentdont' ~ ONT_cov,
      paste0(Aligner, "+", SNVCaller) == 'ug+sentdug' ~ UG_cov
    ),
    Pipeline = case_when(
      paste0(Aligner, "+", SNVCaller) == 'sent+sentd' ~ 'ILMN(sent+sentd)',
      paste0(Aligner, "+", SNVCaller) == 'ont+sentdont' ~ 'ONT(ont+sentdont)',
      paste0(Aligner, "+", SNVCaller) == 'ug+sentdug' ~ 'UG(ug+sentdug)'
    )
  ) %>%
  group_by(CmpFootprint, SNPClass, Pipeline, Coverage) %>%
  summarize(mean_Fscore = mean(Fscore, na.rm=TRUE), .groups='drop')

# Plot combined data
ggplot(combined_data, aes(x = Coverage, y = mean_Fscore, color = SNPClass, shape = Pipeline)) +
  geom_line(aes(linetype=Pipeline), size=0.4) +
  geom_point(size=1.5) +
  facet_wrap(~CmpFootprint) +
  labs(
    x = "Coverage",
    y = "Mean F-score",
    title = "Mean F-score by Coverage, SNP Class, and Pipeline",
    color = "SNP Class",
    shape = "Pipeline",
    linetype = "Pipeline"
  ) +
  theme_bw() +
  theme(axis.text.x = element_text(angle=45, hjust=1)) +
  coord_cartesian(ylim=c(0.99, 1.0))

